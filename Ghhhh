st.subheader("üìù Automatic PCA RV Commentary")

signals = table[table["Direction"] != "NEUTRAL"]

if signals.empty:
    st.write(
        "No statistically significant dislocation detected on the curve. "
        "All residuals remain within ¬±1.5œÉ of the PCA fair-value surface."
    )
else:
    for mat, row in signals.iterrows():
        z = row["Residual_z"]
        d = row["Direction"]

        if d == "BUY":
            txt = (
                f"**{mat}** shows a negative dislocation "
                f"(z = {z:.2f}), trading **too cheap** versus the PCA-implied curve. "
                f"This suggests a **receive / long** RV opportunity with mean-reversion potential."
            )
        else:
            txt = (
                f"**{mat}** shows a positive dislocation "
                f"(z = {z:.2f}), trading **too rich** versus the PCA-implied curve. "
                f"This suggests a **pay / short** RV opportunity."
            )

        st.write("‚Ä¢ " + txt)
